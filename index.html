<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The Alpine Bay</title>

  <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg-start: #020710;
      --bg-mid: #061122;
      --text: #eef3ff;
      --muted: rgba(220,233,255,0.12);
      --glass: rgba(20,40,80,0.55);
      --glass-strong: rgba(10,20,40,0.65);
    }

    html,body{
      height:100%;
      margin:0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(180deg, var(--bg-start), var(--bg-mid) 60%, var(--bg-start));
      color: var(--text);
    }

    header {
      padding: 26px 20px;
      display: flex;
      justify-content: center;
      background: rgba(10,18,32,0.62);
      border-bottom: 1px solid rgba(255,255,255,0.06);
      box-shadow: 0 8px 30px rgba(0,0,0,0.55);
    }

    .header-inner {
      max-width: 1200px;
      width: 100%;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    .title {
      font-size: 1.6rem;
      font-weight: 600;
      color: #dce9ff;
      text-shadow: 0 0 8px rgba(100,160,255,0.30);
    }

    .container {
      max-width: 1000px;
      margin: 36px auto;
      padding: 24px;
    }

    #search {
      padding: 10px 14px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(24,40,72,0.45);
      color: #e9f3ff;
      width:100%;
      max-width:420px;
      margin-bottom: 14px;
    }

    .sort-toggle {
      margin-bottom: 14px;
    }

    .sort-toggle label {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
    }

    .sort-toggle input { display:none; }

    .toggle-ui {
      width: 44px;
      height: 24px;
      border-radius: 14px;
      background: linear-gradient(180deg, rgba(30,55,95,0.9), rgba(15,30,55,0.9));
      border: 1px solid rgba(255,255,255,0.12);
      position: relative;
    }

    .toggle-ui::after {
      content:'';
      position:absolute;
      top:3px;
      left:3px;
      width:18px;
      height:18px;
      border-radius:50%;
      background: linear-gradient(180deg,#eaf3ff,#9fc6ff);
      transition:.2s;
    }

    .sort-toggle input:checked + .toggle-ui::after {
      transform: translateX(20px);
    }

    .toggle-text {
      font-weight:600;
      color:#cfe3ff;
    }

    .game-card {
      background: linear-gradient(145deg, rgba(10,25,50,0.65), rgba(5,10,20,0.75));
      margin: 20px 0;
      padding: 22px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.08);
    }

    .game-card h3{
      margin:0 0 8px 0;
      color:#cfe3ff;
    }

    .version {
      background: linear-gradient(140deg, rgba(22,36,64,0.66), rgba(12,18,36,0.78));
      padding: 10px;
      margin-top: 12px;
      border-radius: 10px;
    }

    a {
      color: #9fc6ff;
      font-weight: 600;
      text-decoration: none;
    }
  </style>
</head>

<body>

<header>
  <div class="header-inner">
    <div class="title">The Alpine Bay</div>
  </div>
</header>

<div class="container">
  <div class="sort-toggle">
    <label>
      <input type="checkbox" id="groupToggle">
      <span class="toggle-ui"></span>
      <span class="toggle-text">Group by series</span>
    </label>
  </div>

  <input type="text" id="search" placeholder="Search games..." />
  <div id="games"></div>
</div>

<script>
(function(){
  const container = document.getElementById('games');
  const search = document.getElementById('search');
  const toggle = document.getElementById('groupToggle');

  let dataCache = [];

  function showMessage(msg){
    container.innerHTML = `<div class="game-card"><p>${msg}</p></div>`;
  }

  function seriesKey(name){
    return name
      .replace(/\b\d+\b/g,'')
      .replace(/(edition|remastered|definitive|collection)/i,'')
      .trim()
      .toLowerCase();
  }

  function render(list){
    container.innerHTML = '';
    if(!list.length){
      showMessage('No games found.');
      return;
    }

    if(!toggle.checked){
      list.forEach(renderGame);
      return;
    }

    const groups = {};
    list.forEach(g=>{
      const k = seriesKey(g.name);
      (groups[k] ||= []).push(g);
    });

    Object.keys(groups).sort().forEach(group=>{
      const h = document.createElement('h2');
      h.textContent = group.toUpperCase();
      h.style.margin = '32px 0 12px';
      container.appendChild(h);
      groups[group].forEach(renderGame);
    });
  }

  function renderGame(game){
    const card = document.createElement('div');
    card.className = 'game-card';
    card.innerHTML = `<h3>${game.name}</h3><p>${game.description||''}</p>`;
    (game.versions||[]).forEach(v=>{
      const ver = document.createElement('div');
      ver.className = 'version';
      ver.innerHTML = `<strong>${v.platform}</strong><br><a href="${v.url}" target="_blank">Download</a>`;
      card.appendChild(ver);
    });
    container.appendChild(card);
  }

  function apply(){
    const t = search.value.toLowerCase();
    render(dataCache.filter(g =>
      g.name.toLowerCase().includes(t) ||
      (g.description && g.description.toLowerCase().includes(t))
    ));
  }

  showMessage('Loading games...');

  fetch('games.json')
    .then(r=>r.json())
    .then(d=>{
      dataCache = d;
      apply();
    })
    .catch(()=>showMessage('Failed to load games.json'));

  search.addEventListener('input', apply);
  toggle.addEventListener('change', apply);
})();
</script>

</body>
</html>
